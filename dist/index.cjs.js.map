{"version":3,"file":"index.cjs.js","sources":["../src/models/form-refresh-type.ts","../src/models/action-type.ts","../src/utils/throw-not-registered.ts","../src/models/store-global-options.ts","../src/utils/debounce.ts","../src/form-base/reducer.ts","../src/form-base/store.ts","../src/validator/regex-list.ts","../src/validator/validate-utis.ts","../src/validator/validator.ts","../src/validator/get-error-default-text.ts","../src/form-base/form-base.ts","../src/form-base/hooks/use-create-input.ts","../src/form-base/hooks/use-error-for-global.ts","../src/form-base/hooks/use-error-for-input.ts","../src/form-context/form-context.tsx","../src/form-context/use-context-form-base.tsx","../src/utils/throw-context-error.ts","../src/dom/form.tsx","../src/dom/hooks/use-create-dom-input.ts","../src/dom/input.tsx","../src/dom/textarea.tsx","../src/dom/form-error.tsx","../src/dom/input-error.tsx","../src/form-base/hooks/use-confirm.tsx","../src/form-base/hooks/use-event-change.ts","../src/form-base/hooks/use-watch.ts","../src/form-base/hooks/use-loading.tsx","../src/form-base/hooks/use-response-data-watch.ts","../src/form-base/hooks/use-store-state-watch.ts"],"sourcesContent":["import { FormBase } from \"../form-base\";\n\nexport enum FormRefreshType {\n\tblur = \"blur\",\n\tinstant = \"instant\",\n}\nexport enum FormShouldValidateType {\n\tYES = \"YES\",\n\tAFTER_FIRST_SUBMIT_ATTEMPT = \"AFTER_FIRST_SUBMIT_ATTEMPT\",\n\tNO = \"NO\",\n}\ntype ShouldValidateFunc = (formBase: FormBase) => boolean;\nexport type FormShouldValidate = FormShouldValidateType | ShouldValidateFunc;\n","export enum ActionType {\n\tINIT = \"INIT\",\n\tNEW_VALUE = \"NEW_VALUE\",\n\tBLURRED = \"BLURRED\",\n\tASYNC_VALIDATION = \"ASYNC_VALIDATION\",\n\tSUBMIT_STARTED = \"SUBMIT_STARTED\",\n\tSUBMIT_ERROR = \"SUBMIT_ERROR\",\n\tSUBMIT_SUCCEED = \"SUBMIT_SUCCEED\",\n\tNEW_VALUE_DEBOUNCED = \"NEW_VALUE_DEBOUNCED\",\n\tBLURRED_DEBOUNCED = \"BLURRED_DEBOUNCED\",\n}\n\nexport interface EventType {\n\tindex: number;\n\tactionProps: ActionProps;\n}\nexport type ActionProps = { type: ActionType; payload?: any };\nexport interface InputStateProps {\n\tname: string;\n}\nexport interface NewValueProps extends InputStateProps {\n\tvalidateRequired: boolean | undefined;\n\terror: any;\n\tvalue: number;\n}\nexport interface BlurStateProps extends InputStateProps {\n\tvalidateRequired: boolean | undefined;\n\terror: any;\n}\nexport interface DebounceChangeType extends InputStateProps {\n\tvalidateRequired: boolean | undefined;\n\terror: any;\n}\nexport interface AsyncValidationProps extends InputStateProps {\n\tforSubmit: boolean;\n\tvalue: any;\n}\nexport interface SubmitStartedProps {\n\tconfirmActive: boolean;\n}\nexport interface SubmitErrorPayload {\n\terror: any;\n}\n","export function throwNotRegistered(name: string) {\n\treturn new Error(`\"${name}\" is not registered`);\n}\n","import { FormRefreshType } from \"./form-refresh-type\";\n\nexport interface StoreGlobalOptions {\n\trefreshType: FormRefreshType;\n\tdebounceNumber?: number;\n}\nexport const defaultStoreGlobalOptions: StoreGlobalOptions = {\n\trefreshType: FormRefreshType.instant,\n\tdebounceNumber: undefined,\n};\n","export class Debounce {\n\ttime: number;\n\t__select_time: 0;\n\n\tconstructor(time = 800) {\n\t\tthis.time = time;\n\t\tthis.__select_time = 0;\n\t}\n\n\tpublic cb(cb: any) {\n\t\tthis.reset();\n\t\t// @ts-ignore\n\t\tthis.__select_time = setTimeout(() => {\n\t\t\tcb && cb();\n\t\t}, this.time);\n\t}\n\n\tprivate reset() {\n\t\tclearTimeout(this.__select_time);\n\t}\n}\n","import {\n\tActionProps,\n\tActionType,\n\tAsyncValidationProps,\n\tBlurStateProps,\n\tDebounceChangeType,\n\tNewValueProps,\n\tSubmitErrorPayload,\n\tSubmitStartedProps,\n} from \"../models/action-type\";\nimport { throwNotRegistered } from \"../utils\";\nimport { FormRefreshType, InputState, StoreState } from \"../models\";\n\nexport function reducer(state: StoreState, action: ActionProps): StoreState {\n\tfunction setError(currentInputState: InputState) {\n\t\tif (currentInputState.error) {\n\t\t\tstate.formState.formStatus = \"ERROR\";\n\t\t} else {\n\t\t\tif (state.formState.formStatus !== \"ERROR\") {\n\t\t\t\tstate.formState.formStatus = \"NOT-CLEAN\";\n\t\t\t} else {\n\t\t\t\tstate.formState.formStatus = Object.values(state.inputStates).reduce((p, c) => p && !!c.error, false)\n\t\t\t\t\t? \"ERROR\"\n\t\t\t\t\t: \"NOT-CLEAN\";\n\t\t\t}\n\t\t}\n\t}\n\n\tswitch (action.type) {\n\t\tcase ActionType.INIT:\n\t\t\tstate.formState.formStatus = \"CLEAN\";\n\t\t\tbreak;\n\t\tcase ActionType.BLURRED_DEBOUNCED:\n\t\tcase ActionType.NEW_VALUE_DEBOUNCED: {\n\t\t\tconst payload = action.payload as DebounceChangeType;\n\t\t\tconst error = payload.error;\n\t\t\tconst validateRequired = payload.validateRequired;\n\t\t\tconst currentInputState = state.inputStates[payload.name];\n\t\t\tif (!currentInputState) {\n\t\t\t\tthrow throwNotRegistered(payload.name);\n\t\t\t}\n\t\t\tcurrentInputState.value = currentInputState._refreshValue;\n\t\t\tif (error && !Array.isArray(error)) {\n\t\t\t\tthrow new Error(\"error must be array\");\n\t\t\t}\n\t\t\tcurrentInputState.error = error;\n\t\t\tcurrentInputState.validateRequired = validateRequired ?? currentInputState.validateRequired;\n\t\t\tsetError(currentInputState);\n\t\t\tbreak;\n\t\t}\n\t\tcase ActionType.NEW_VALUE: {\n\t\t\tconst payload = action.payload as NewValueProps;\n\t\t\tconst value = payload.value;\n\t\t\tconst error = payload.error;\n\t\t\tconst validateRequired = payload.validateRequired;\n\t\t\tconst currentInputState = state.inputStates[payload.name];\n\t\t\tif (!currentInputState) {\n\t\t\t\tthrow throwNotRegistered(payload.name);\n\t\t\t}\n\t\t\tcurrentInputState._refreshValue = value;\n\t\t\tif (state.formState.refreshType === FormRefreshType.instant) {\n\t\t\t\tif (!state.formState.debounceNumber || state.formState.debounceNumber === 0) {\n\t\t\t\t\tcurrentInputState.value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (error && !Array.isArray(error)) {\n\t\t\t\tthrow new Error(\"error must be array\");\n\t\t\t}\n\t\t\tcurrentInputState.error = error;\n\t\t\tcurrentInputState.validateRequired = validateRequired ?? currentInputState.validateRequired;\n\t\t\tsetError(currentInputState);\n\t\t\tbreak;\n\t\t}\n\t\tcase ActionType.BLURRED: {\n\t\t\tif (state.formState.refreshType !== FormRefreshType.blur) break;\n\t\t\tconst payload = action.payload as BlurStateProps;\n\t\t\tconst error = payload.error;\n\t\t\tconst validateRequired = payload.validateRequired;\n\t\t\tconst currentInputState = state.inputStates[payload.name];\n\t\t\tif (!currentInputState) {\n\t\t\t\tthrow throwNotRegistered(payload.name);\n\t\t\t}\n\t\t\tcurrentInputState.value = currentInputState._refreshValue;\n\t\t\tif (error && !Array.isArray(error)) {\n\t\t\t\tthrow new Error(\"error must be array\");\n\t\t\t}\n\t\t\tcurrentInputState.error = error;\n\t\t\tcurrentInputState.validateRequired = validateRequired ?? currentInputState.validateRequired;\n\t\t\tsetError(currentInputState);\n\t\t\tbreak;\n\t\t}\n\n\t\tcase ActionType.SUBMIT_STARTED: {\n\t\t\tconst payload = action.payload as SubmitStartedProps;\n\t\t\tstate.formState.loading = true;\n\t\t\tstate.formState.confirmActive = payload.confirmActive;\n\t\t\tstate.formState.submitAttemptNumber++;\n\t\t\tbreak;\n\t\t}\n\t\tcase ActionType.SUBMIT_SUCCEED: {\n\t\t\tstate.formState.confirmActive = false;\n\t\t\tstate.formState.loading = false;\n\t\t\tObject.values(state.inputStates).forEach((s) => {\n\t\t\t\ts.validateRequired = false;\n\t\t\t});\n\t\t\tstate.formState.formStatus = \"SUCCESS\";\n\t\t\tbreak;\n\t\t}\n\t\tcase ActionType.SUBMIT_ERROR: {\n\t\t\tconst payload = action.payload as SubmitErrorPayload;\n\t\t\tstate.formState.confirmActive = false;\n\t\t\tstate.formState.loading = false;\n\t\t\tObject.values(state.inputStates).forEach((s) => {\n\t\t\t\ts.validateRequired = false;\n\t\t\t});\n\t\t\tstate.formState.formStatus = \"ERROR\";\n\t\t\tconst error = payload.error;\n\t\t\tif (!error) {\n\t\t\t\tconsole.warn(\"Wrong usage, error must be filled if success is false\");\n\t\t\t} else {\n\t\t\t\tif (Array.isArray(error)) {\n\t\t\t\t\terror.forEach((e) => {\n\t\t\t\t\t\tif (e instanceof Error || !e.name) {\n\t\t\t\t\t\t\tstate.formState.error = e;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst currentInputState = state.inputStates[e.name];\n\t\t\t\t\t\t\tif (currentInputState) {\n\t\t\t\t\t\t\t\tcurrentInputState.error = Array.isArray(e) ? e : [e];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t\tif (error instanceof Error || !error.name) {\n\t\t\t\t\t\tstate.formState.error = error;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst currentInputState = state.inputStates[error.name];\n\t\t\t\t\t\tif (currentInputState) {\n\t\t\t\t\t\t\tcurrentInputState.error = [error];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tcase ActionType.ASYNC_VALIDATION: {\n\t\t\tconst payload = action.payload as AsyncValidationProps;\n\t\t\tconst currentInputState = state.inputStates[payload.name];\n\t\t\tif (!currentInputState) {\n\t\t\t\tthrow throwNotRegistered(payload.name);\n\t\t\t}\n\t\t\tif (payload.forSubmit) {\n\t\t\t\tstate.formState.loading = payload.value;\n\t\t\t}\n\t\t\tcurrentInputState.validateLoading = payload.value;\n\t\t\tbreak;\n\t\t}\n\t\tdefault:\n\t\t\tthrow new Error(\"Unexpected Action Type\");\n\t}\n\n\treturn state;\n}\n","import { Debounce } from \"../utils\";\nimport { CreateInputOptions, FormRawData, FormRefreshType, IValidationStore, StoreState } from \"../models\";\nimport { ActionProps, ActionType, EventType } from \"../models/action-type\";\nimport { ValidatorToValidatorFunc } from \"../validator\";\n\ntype SubscribeType = (state: StoreState) => void;\n\nexport class Store implements IValidationStore {\n\tprivate listeners: SubscribeType[] = [];\n\tprivate instantListeners: SubscribeType[] = [];\n\tprivate readonly debounce?: Debounce;\n\tpublic __inputValidationFunctions__: Record<string, ValidatorToValidatorFunc> = {};\n\tpublic __lastEvent__: EventType = { actionProps: { type: ActionType.INIT, payload: undefined }, index: 0 };\n\n\tconstructor(public state: StoreState, private reducer: (state: StoreState, action: ActionProps) => StoreState) {\n\t\tthis.debounce =\n\t\t\tstate.formState.debounceNumber && state.formState.debounceNumber > 0\n\t\t\t\t? new Debounce(state.formState.debounceNumber)\n\t\t\t\t: undefined;\n\t}\n\n\tpublic subscribe(fn: SubscribeType) {\n\t\tthis.listeners.push(fn);\n\t\treturn () => {\n\t\t\tthis.listeners.splice(this.listeners.indexOf(fn), 1);\n\t\t};\n\t}\n\n\tpublic subscribeInstant(fn: (state: StoreState) => void) {\n\t\tthis.instantListeners.push(fn);\n\t\treturn () => {\n\t\t\tthis.listeners.splice(this.instantListeners.indexOf(fn), 1);\n\t\t};\n\t}\n\n\tpublic dispatch(action: ActionProps) {\n\t\tthis.__lastEvent__ = {\n\t\t\tactionProps: { type: action.type, payload: action.payload },\n\t\t\tindex: this.__lastEvent__.index + 1,\n\t\t};\n\n\t\tif (\n\t\t\t((action.type === ActionType.NEW_VALUE && this.state.formState.refreshType === FormRefreshType.instant) ||\n\t\t\t\t(action.type === ActionType.BLURRED && this.state.formState.refreshType === FormRefreshType.blur)) &&\n\t\t\tthis.state.formState.debounceNumber &&\n\t\t\tthis.state.formState.debounceNumber > 0\n\t\t) {\n\t\t\tconsole.log(\"debounce\", action, this.state.formState.refreshType);\n\t\t\tthis.debounce?.cb(() => {\n\t\t\t\tif (action.type === ActionType.BLURRED) {\n\t\t\t\t\tthis.dispatch({ type: ActionType.NEW_VALUE_DEBOUNCED, payload: action.payload });\n\t\t\t\t} else {\n\t\t\t\t\tthis.dispatch({ type: ActionType.BLURRED_DEBOUNCED, payload: action.payload });\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tthis.state = this.reducer(this.state, action);\n\t\t\tthis.instantBroadcast();\n\t\t\tthis.broadcast();\n\t\t}\n\t}\n\n\tpublic getValidationData(): FormRawData {\n\t\treturn Object.entries(this.state.inputStates)\n\t\t\t.filter(([, inputState]) => inputState.validateRequired)\n\t\t\t.reduce<FormRawData>((data, [key, inputState]) => {\n\t\t\t\tdata[key] = inputState.value;\n\t\t\t\treturn data;\n\t\t\t}, {});\n\t}\n\n\tpublic createInput(name: string, options: CreateInputOptions) {\n\t\tif (this.state.inputStates[name]) {\n\t\t\treturn this.state.inputStates[name];\n\t\t} else {\n\t\t\tthis.state.inputStates[name] = {\n\t\t\t\tname: name,\n\t\t\t\tvalue: options.defaultValue,\n\t\t\t\tvalidateLoading: false,\n\t\t\t\t_refreshValue: options.defaultValue,\n\t\t\t\tvalidateRequired: true,\n\t\t\t\terror: undefined,\n\t\t\t};\n\t\t}\n\t}\n\n\tpublic broadcast() {\n\t\tthis.listeners.forEach((l) => l(this.state));\n\t}\n\n\tpublic instantBroadcast() {\n\t\tthis.instantListeners.forEach((l) => l(this.state));\n\t}\n\n\tpublic getRawData(): FormRawData {\n\t\treturn Object.entries(this.state.inputStates).reduce<FormRawData>((data, [key, inputState]) => {\n\t\t\tdata[key] = inputState.value;\n\t\t\treturn data;\n\t\t}, {});\n\t}\n\n\tpublic getShouldValidateAgain() {\n\t\treturn Object.values(this.state.inputStates).reduce((sum, r) => sum || r.validateRequired, false);\n\t}\n\n\tpublic addValidation(name: string, validation?: ValidatorToValidatorFunc) {\n\t\tif (validation) {\n\t\t\tthis.__inputValidationFunctions__[name] = validation;\n\t\t} else {\n\t\t\tthis.__inputValidationFunctions__[name] = undefined;\n\t\t}\n\t}\n}\n","//cp: https://stackoverflow.com/a/29767609\nexport const phoneRegex = /^[+]?[(]?[0-9]{3}[)]?[-\\s.]?[0-9]{3}[-\\s.]?[0-9]{4,6}$/im;\n//cp: https://stackoverflow.com/a/46181\nexport const emailRegex =\n\t/^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n//cp: https://stackoverflow.com/a/3809435\nexport const urlHttpRegex =\n\t/https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&/=]*)/;\n","import { emailRegex, phoneRegex, urlHttpRegex } from \"./regex-list\";\n\nexport function required(value: any): boolean {\n\treturn !!value;\n}\n\nexport function min(value: any, payload: number): boolean {\n\tif (!value) return true;\n\tlet _value = Number(value);\n\treturn !isNaN(_value) && _value > payload;\n}\n\nexport function minLength(value: any, payload: number): boolean {\n\tif (!value) return true;\n\treturn typeof value === \"string\" && value.length > payload;\n}\n\nexport function max(value: any, payload: number) {\n\tif (!value) return true;\n\tlet _value = Number(value);\n\treturn !isNaN(_value) && _value < payload;\n}\n\nexport function maxLength(value: any, payload: number): boolean {\n\tif (!value) return true;\n\treturn typeof value === \"string\" && value.length < payload;\n}\n\n//inspired: https://stackoverflow.com/a/46181\nexport function email(value: any): boolean {\n\tif (!value) return true;\n\treturn typeof value === \"string\" && !!value.toLowerCase().match(emailRegex);\n}\n\n//inspired: https://stackoverflow.com/a/29767609\nexport function phone(value: any): boolean {\n\tif (!value) return true;\n\treturn typeof value === \"string\" && !!value.match(phoneRegex);\n}\n\nexport function repeatPassword(value: any, payload?: string): boolean {\n\tif (!payload) return true;\n\treturn value === payload;\n}\n\n//inspired: https://stackoverflow.com/a/3809435\nexport function url(value: any): boolean {\n\tif (!value) return true;\n\treturn typeof value === \"string\" && !!value.match(urlHttpRegex);\n}\n\nexport function customRegex(value: any, regex: RegExp): boolean {\n\tif (!value) return true;\n\treturn typeof value === \"string\" && regex.test(value);\n}\n","import {\n\tcustomRegex,\n\temail,\n\tmax,\n\tmaxLength,\n\tmin,\n\tminLength,\n\tphone,\n\trepeatPassword,\n\trequired,\n\turl,\n} from \"./validate-utis\";\nimport { IValidationStore } from \"../models\";\n\ntype validateFunc = ((value: any, payload: any) => boolean) | ((value: any) => boolean);\ntype validateAsyncFunc = ((value: any, payload: any) => boolean) | ((value: any) => Promise<boolean>);\nexport type ValidatorToValidatorFunc = ((v: Validator) => Validator) | undefined;\nexport enum ValidatorType {\n\trequired = \"required\",\n\tmin = \"min\",\n\tminLength = \"minLength\",\n\tmax = \"max\",\n\tmaxLength = \"maxLength\",\n\temail = \"email\",\n\tphone = \"phone\",\n\trepeatPassword = \"repeatPassword\",\n\turl = \"url\",\n\tregex = \"regex\",\n}\n\ntype ValidatorTypeInterface = Record<ValidatorType, ((payload: any) => Validator) | (() => Validator)>;\n\ninterface ValidatorSettings {\n\tvalidateAll: boolean;\n}\n\nexport class Validator implements ValidatorTypeInterface {\n\tvalidations: Record<string, { payload?: any; fn: validateFunc | validateAsyncFunc; async: boolean }> = {};\n\tsettings: ValidatorSettings = { validateAll: false };\n\tconstructor(private store: IValidationStore, private validateName: string) {}\n\n\tpublic required(): Validator {\n\t\treturn this.register(ValidatorType.required, required);\n\t}\n\n\tpublic min(v: number): Validator {\n\t\treturn this.register(ValidatorType.min, min, v);\n\t}\n\n\tpublic minLength(v: number): Validator {\n\t\treturn this.register(ValidatorType.minLength, minLength, v);\n\t}\n\n\tpublic max(v: number): Validator {\n\t\treturn this.register(ValidatorType.max, max, v);\n\t}\n\n\tpublic maxLength(v: number): Validator {\n\t\treturn this.register(ValidatorType.maxLength, maxLength, v);\n\t}\n\n\tpublic email(): Validator {\n\t\treturn this.register(ValidatorType.email, email);\n\t}\n\n\tpublic phone(): Validator {\n\t\treturn this.register(ValidatorType.phone, phone);\n\t}\n\n\tpublic repeatPassword(payload: string): Validator {\n\t\tconst storeData = this.store.getRawData();\n\t\treturn this.register(ValidatorType.repeatPassword, repeatPassword, storeData ? storeData[payload] : undefined);\n\t}\n\n\tpublic url(): Validator {\n\t\treturn this.register(ValidatorType.url, url);\n\t}\n\n\tpublic regex(regex: RegExp): Validator {\n\t\treturn this.register(ValidatorType.regex, customRegex, regex);\n\t}\n\n\tpublic validate(name: string, fn: (value: any) => boolean, payload?: any) {\n\t\treturn this.register(\"custom_\" + this.validateName, fn, Number(payload));\n\t}\n\n\tpublic async(name: string, fn: (value: any) => Promise<boolean>, payload?: any) {\n\t\treturn this.registerAsync(name, fn, payload);\n\t}\n\tpublic set(param: { validateAll: boolean }) {\n\t\tthis.settings = {\n\t\t\t...this.settings,\n\t\t\tvalidateAll: param.validateAll,\n\t\t};\n\t\treturn this;\n\t}\n\tprotected register(name: string, fn: validateFunc, payload?: any) {\n\t\tthis.validations[name] = {\n\t\t\tfn,\n\t\t\tpayload,\n\t\t\tasync: false,\n\t\t};\n\t\treturn this;\n\t}\n\n\tprotected registerAsync(name: string, fn: validateAsyncFunc, payload?: any) {\n\t\tthis.validations[name] = {\n\t\t\tfn,\n\t\t\tpayload,\n\t\t\tasync: true,\n\t\t};\n\t\treturn this;\n\t}\n}\n","import { ValidatorType } from \"./validator\";\nimport { ValidateError } from \"../models\";\n\nexport function getErrorDefaultText(error: ValidateError) {\n\tconsole.log(\"error\", error);\n\tswitch (error.type as ValidatorType) {\n\t\tcase ValidatorType.required:\n\t\t\treturn \"This Field is required.\";\n\t\tcase ValidatorType.min:\n\t\t\treturn \"Minimum required number is \" + error.payload;\n\t\tcase ValidatorType.minLength:\n\t\t\treturn (\n\t\t\t\t\"Minimum \" + error.payload + \" \" + (error.payload === 1 ? \"character\" : \"characters\") + \" are allowed\"\n\t\t\t);\n\t\tcase ValidatorType.max:\n\t\t\treturn \"Maximum required number is \" + error.payload;\n\t\tcase ValidatorType.maxLength:\n\t\t\treturn (\n\t\t\t\t\"Maximum \" + error.payload + \" \" + (error.payload === 1 ? \"character\" : \"characters\") + \" are allowed\"\n\t\t\t);\n\t\tcase ValidatorType.email:\n\t\t\treturn \"Please enter a valid email address.\";\n\t\tcase ValidatorType.phone:\n\t\t\treturn \"Please enter a valid phone number.\";\n\t\tcase ValidatorType.repeatPassword:\n\t\t\treturn (error && error.name ? error.name : \"Password \") + \" is not matched.\";\n\t\tcase ValidatorType.url:\n\t\t\treturn \"Please enter a valid url.\";\n\t}\n\treturn error.payload?.message || \"Invalid field\";\n}\n","import { reducer } from \"./reducer\";\nimport { ActionType } from \"../models\";\nimport { Store } from \"./store\";\nimport { Validator, ValidatorToValidatorFunc } from \"../validator\";\nimport {\n\tConfirm,\n\tConfirmForm,\n\tCreateInputOptions,\n\tFormRefreshType,\n\tFormShouldValidateType,\n\tFormState,\n\tFormUtils,\n\tResponseData,\n\tUseFormBaseProps,\n\tValidateError,\n} from \"../models\";\nimport { throwNotRegistered } from \"../utils\";\n\ntype SubmitResult = Promise<void> | void;\n\nexport class FormBase {\n\tconfirm: ConfirmForm | null = null;\n\tpublic readonly store: Store;\n\n\tconstructor({\n\t\trefreshType = FormRefreshType.blur,\n\t\tshouldValidate = FormShouldValidateType.AFTER_FIRST_SUBMIT_ATTEMPT,\n\t\tdebounceNumber = undefined,\n\t}: UseFormBaseProps) {\n\t\tthis.store = new Store(\n\t\t\t{\n\t\t\t\tformState: {\n\t\t\t\t\tformStatus: \"CLEAN\",\n\t\t\t\t\tconfirmActive: false,\n\t\t\t\t\terror: null,\n\t\t\t\t\tloading: false,\n\t\t\t\t\tdebounceNumber,\n\t\t\t\t\trefreshType,\n\t\t\t\t\tshouldValidate,\n\t\t\t\t\tsubmitAttemptNumber: 0,\n\t\t\t\t},\n\t\t\t\tinputStates: {},\n\t\t\t},\n\t\t\treducer\n\t\t);\n\t\t//I prefer to use this instead of fat arrow functions\n\t\tthis.onSubmit = this.onSubmit.bind(this);\n\t}\n\n\tpublic getDataWithoutValidation(): ResponseData {\n\t\tconst data = this.store.getRawData();\n\t\treturn {\n\t\t\tisValid: undefined,\n\t\t\tvalidateErrors: undefined,\n\t\t\tshouldValidateAgain: this.store.getShouldValidateAgain(),\n\t\t\tloading: this.store.state.formState.loading,\n\t\t\tdata,\n\t\t};\n\t}\n\n\tpublic async getDataWithValidation(\n\t\tvalidate: boolean,\n\t\t{ validateLoading }: { validateLoading: boolean }\n\t): Promise<ResponseData> {\n\t\tconst data = this.store.getRawData();\n\t\tconst responseData: ResponseData = {\n\t\t\tisValid: undefined,\n\t\t\tvalidateErrors: undefined,\n\t\t\tshouldValidateAgain: this.store.getShouldValidateAgain(),\n\t\t\tloading: this.store.state.formState.loading,\n\t\t\tdata,\n\t\t};\n\t\tif (validate) {\n\t\t\tconst validateErrors = await this.validate(data, { validateLoading });\n\t\t\tresponseData.isValid = !(validateErrors && validateErrors.length);\n\t\t\tresponseData.validateErrors = validateErrors;\n\t\t}\n\t\treturn responseData;\n\t}\n\n\tpublic async onSubmit(formSubmitFunction?: (data: ResponseData, utils: FormUtils) => SubmitResult) {\n\t\tconst state = this.store.state;\n\t\tconst formState = state.formState;\n\t\tObject.values(state.inputStates).forEach((is) => {\n\t\t\tis.value = is._refreshValue;\n\t\t});\n\t\tif (formState.loading) {\n\t\t\tconsole.warn(\"Double click detect\");\n\t\t}\n\t\tif (formState.confirmActive) {\n\t\t\tconsole.warn(\"Form submitted when confirm active\");\n\t\t}\n\t\tthis.store.dispatch({\n\t\t\ttype: ActionType.SUBMIT_STARTED,\n\t\t\tpayload: {\n\t\t\t\tconfirmActive: true,\n\t\t\t},\n\t\t});\n\t\tconst responseData = await this.getDataWithValidation(true, { validateLoading: true });\n\t\tif (responseData.isValid) {\n\t\t\ttry {\n\t\t\t\tconst confirm = (_fn: Confirm) => {\n\t\t\t\t\tthis.confirm = (succeed, payload) => {\n\t\t\t\t\t\tif (succeed) {\n\t\t\t\t\t\t\tconst result = _fn(payload);\n\t\t\t\t\t\t\tthis.onSubmitResult(result);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.store.dispatch({\n\t\t\t\t\t\t\t\ttype: ActionType.SUBMIT_ERROR,\n\t\t\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\t\t\t\terror: payload,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t\tconst result =\n\t\t\t\t\tformSubmitFunction &&\n\t\t\t\t\tformSubmitFunction(responseData, {\n\t\t\t\t\t\tconfirm,\n\t\t\t\t\t});\n\t\t\t\tif (formState.confirmActive) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.onSubmitResult(result);\n\t\t\t} catch (error: any) {\n\t\t\t\tthis.store.dispatch({\n\t\t\t\t\ttype: ActionType.SUBMIT_ERROR,\n\t\t\t\t\tpayload: {\n\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\terror,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tconst errors = [];\n\t\t\tif (responseData.validateErrors) {\n\t\t\t\tfor (let i = 0; i < responseData.validateErrors.length; i++) {\n\t\t\t\t\tconst e = responseData.validateErrors[i];\n\t\t\t\t\terrors.push({ value: e.value, name: e.name, payload: e.payload, type: e.type });\n\t\t\t\t}\n\t\t\t\tthis.store.dispatch({\n\t\t\t\t\ttype: ActionType.SUBMIT_ERROR,\n\t\t\t\t\tpayload: { error: errors },\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic shouldValidate(formState: FormState) {\n\t\tconst shouldValidateObj = this.store.state.formState.shouldValidate;\n\t\tlet shouldValidate = false;\n\t\tif (typeof shouldValidateObj === \"function\") {\n\t\t\tshouldValidate = shouldValidateObj(this);\n\t\t} else {\n\t\t\tconst shouldValidateType: FormShouldValidateType = shouldValidateObj;\n\t\t\tif (shouldValidateType === FormShouldValidateType.YES) {\n\t\t\t\tshouldValidate = true;\n\t\t\t} else if (shouldValidateType === FormShouldValidateType.AFTER_FIRST_SUBMIT_ATTEMPT) {\n\t\t\t\tif (formState.submitAttemptNumber > 0) {\n\t\t\t\t\tshouldValidate = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn shouldValidate;\n\t}\n\n\tpublic createInput(name: string, options: CreateInputOptions) {\n\t\tthis.store.createInput(name, options);\n\t\tif (options.validation) {\n\t\t\tthis.store.__inputValidationFunctions__[name] = options.validation;\n\t\t} else {\n\t\t\tthis.store.__inputValidationFunctions__[name] = undefined;\n\t\t}\n\t\treturn {\n\t\t\tonChange: (value: any) => {\n\t\t\t\tthis.setValue(name, value).then();\n\t\t\t},\n\t\t\tonBlur: async () => {\n\t\t\t\tconsole.log(\"this.store.state.formState.refreshType\", this.store.state.formState.refreshType);\n\t\t\t\tif (this.store.state.formState.refreshType !== FormRefreshType.blur) return;\n\t\t\t\t//https://stackoverflow.com/questions/44142273/react-ul-with-onblur-event-is-preventing-onclick-from-firing-on-li\n\t\t\t\t//I added to solve rerender problem. Do we need it??\n\t\t\t\tsetTimeout(async () => {\n\t\t\t\t\tlet error;\n\t\t\t\t\tconst inputState = this.store.state.inputStates[name];\n\t\t\t\t\tconst value = inputState?._refreshValue;\n\t\t\t\t\tif (inputState?.validateRequired) {\n\t\t\t\t\t\terror = await this.validateInput(name, value);\n\t\t\t\t\t}\n\t\t\t\t\tthis.store.dispatch({\n\t\t\t\t\t\ttype: ActionType.BLURRED,\n\t\t\t\t\t\tpayload: { name, error, validateRequired: error === undefined },\n\t\t\t\t\t});\n\t\t\t\t}, 50);\n\t\t\t},\n\t\t\taddValidation: (validatorToValidatorFunc: ValidatorToValidatorFunc) => {\n\t\t\t\tthis.store.addValidation(name, validatorToValidatorFunc);\n\t\t\t},\n\t\t};\n\t}\n\n\tpublic deleteInput(name: string) {\n\t\tthis.checkNameExist(name);\n\t\tdelete this.store.state.inputStates[name];\n\t}\n\n\tpublic async setValue(name: string, value: any) {\n\t\tthis.checkNameExist(name);\n\t\tconst formState = this.store.state.formState;\n\t\tlet error = null;\n\t\tlet validated = false;\n\t\tif (formState.refreshType === FormRefreshType.instant) {\n\t\t\terror = await this.validateInput(name, value);\n\t\t\tvalidated = true;\n\t\t}\n\t\tthis.store.dispatch({\n\t\t\ttype: ActionType.NEW_VALUE,\n\t\t\tpayload: {\n\t\t\t\tvalue,\n\t\t\t\tname,\n\t\t\t\terror,\n\t\t\t\tvalidateRequired: !validated,\n\t\t\t},\n\t\t});\n\t}\n\n\tprivate async validateInput(name: string, value: any) {\n\t\tthis.checkNameExist(name);\n\t\tconst formState = this.store.state.formState;\n\t\tconst validationFunction = this.store.__inputValidationFunctions__[name];\n\t\tif (!validationFunction) return null;\n\t\tconst shouldValidate = this.shouldValidate(formState);\n\t\tif (!shouldValidate) return undefined;\n\t\tconst validator = new Validator(this.store, \"validator_\" + name);\n\t\tconst validation = validationFunction(validator);\n\t\tif (!validation) return null;\n\t\tlet array = [];\n\t\tconst vKeys = Object.keys(validation.validations);\n\t\tfor (let j = 0; j < vKeys.length; j++) {\n\t\t\tif (array.length) {\n\t\t\t\tif (!validation.settings.validateAll) {\n\t\t\t\t\treturn array;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst vKey = vKeys[j];\n\t\t\tconst vObj = validation.validations[vKey];\n\t\t\tconst obj = vObj.fn(value, vObj.payload);\n\t\t\tif (!obj) array.push([{ name: name, type: vKey, value, payload: vObj.payload }]);\n\t\t\t// @ts-ignore\n\t\t\tif (obj && obj.then) {\n\t\t\t\tthis.store.dispatch({\n\t\t\t\t\ttype: ActionType.ASYNC_VALIDATION,\n\t\t\t\t\tpayload: { name, value: true, forSubmit: false },\n\t\t\t\t});\n\t\t\t\tconst result = await obj;\n\t\t\t\tthis.store.dispatch({\n\t\t\t\t\ttype: ActionType.ASYNC_VALIDATION,\n\t\t\t\t\tpayload: { name, value: false, forSubmit: false },\n\t\t\t\t});\n\t\t\t\tif (!result) {\n\t\t\t\t\tarray.push({ name: name, type: vKey, value, payload: vObj.payload });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn array;\n\t}\n\n\tprivate async validate(data: any, { validateLoading }: { validateLoading: boolean }): Promise<ValidateError[]> {\n\t\tconst errors = [];\n\t\tconst keys = Object.keys(data);\n\t\tfor (let i = 0; i < keys.length; i++) {\n\t\t\tconst name = keys[i];\n\t\t\tconst validationFunction = this.store.__inputValidationFunctions__[name];\n\t\t\tif (!validationFunction) continue;\n\t\t\tconst validation = validationFunction(new Validator(this.store, \"validator_\" + name));\n\t\t\tif (!validation) continue;\n\t\t\tconst vKeys = Object.keys(validation.validations);\n\t\t\tfor (let j = 0; j < vKeys.length; j++) {\n\t\t\t\tconst vKey = vKeys[j];\n\t\t\t\tconst vObj = validation.validations[vKey];\n\t\t\t\tconst value = data[name];\n\t\t\t\tconst obj = vObj.fn(value, vObj.payload);\n\t\t\t\tif (!obj) errors.push({ name: name, type: vKey, value, payload: vObj.payload });\n\t\t\t\t// @ts-ignore\n\t\t\t\tif (obj && obj.then) {\n\t\t\t\t\tvalidateLoading &&\n\t\t\t\t\t\tthis.store.dispatch({\n\t\t\t\t\t\t\ttype: ActionType.ASYNC_VALIDATION,\n\t\t\t\t\t\t\tpayload: { name, value: true, forSubmit: true },\n\t\t\t\t\t\t});\n\t\t\t\t\tconst result = await obj;\n\t\t\t\t\tvalidateLoading &&\n\t\t\t\t\t\tthis.store.dispatch({\n\t\t\t\t\t\t\ttype: ActionType.ASYNC_VALIDATION,\n\t\t\t\t\t\t\tpayload: { name, value: false, forSubmit: true },\n\t\t\t\t\t\t});\n\t\t\t\t\tif (!result) {\n\t\t\t\t\t\terrors.push({ name: name, type: vKey, value, payload: vObj.payload });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn errors;\n\t}\n\tprivate checkNameExist(name: string) {\n\t\tif (!this.store.state.inputStates[name]) {\n\t\t\tthrow throwNotRegistered(name);\n\t\t}\n\t}\n\n\tprivate onSubmitResult(result: undefined | Promise<void> | void) {\n\t\tif (result && result.then !== undefined) {\n\t\t\tconst promise: Promise<any> = result as Promise<any>;\n\t\t\tpromise\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.store.dispatch({\n\t\t\t\t\t\ttype: ActionType.SUBMIT_SUCCEED,\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch((e: any) => {\n\t\t\t\t\tthis.store.dispatch({\n\t\t\t\t\t\ttype: ActionType.SUBMIT_ERROR,\n\t\t\t\t\t\tpayload: {\n\t\t\t\t\t\t\terror: e,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t} else {\n\t\t\tthis.store.dispatch({\n\t\t\t\ttype: ActionType.SUBMIT_SUCCEED,\n\t\t\t});\n\t\t}\n\t}\n}\n","import { useInsertionEffect, useMemo } from \"react\";\nimport { FormBase } from \"../form-base\";\nimport { ValidatorToValidatorFunc } from \"../../validator\";\n\nexport function useCreateInput(\n\tformBase: FormBase,\n\tname: string,\n\tdefaultParams: { defaultValue?: any; validation?: ValidatorToValidatorFunc } = {}\n): { onChange: any; onBlur: any } {\n\tconst result = formBase.createInput(name, {\n\t\tdefaultValue: defaultParams.defaultValue,\n\t\tvalidation: defaultParams.validation,\n\t});\n\n\tuseInsertionEffect(() => {\n\t\treturn () => formBase.deleteInput(name);\n\t}, [formBase, name]);\n\treturn result;\n}\n","import { FormBase } from \"../form-base\";\nimport { useEffect, useState } from \"react\";\n\nexport function useErrorForGlobal(formBase: FormBase) {\n\tconst [state, setState] = useState<any>(() => formBase.store.state.formState?.error);\n\tuseEffect(() => {\n\t\tsetState(formBase.store.state.formState?.error);\n\t}, [formBase]);\n\tuseEffect(() => {\n\t\tconst callback = () => {\n\t\t\tconst formState = formBase.store.state.formState;\n\t\t\tsetState(formState?.error);\n\t\t};\n\t\treturn formBase.store.subscribe(callback);\n\t}, [formBase]);\n\treturn state;\n}\n","import { useEffect, useState } from \"react\";\nimport { FormBase } from \"../form-base\";\nimport { InputState, ValidateError } from \"../../models\";\n\nexport function useErrorForInput(formBase: FormBase, name: string) {\n\tconst [state, setState] = useState<ValidateError[] | undefined>(\n\t\t() => formBase.store.state.inputStates[name]?.error\n\t);\n\tconst [loading, setLoading] = useState<any>(() => formBase.store.state.inputStates[name]?.validateLoading);\n\tuseEffect(() => {\n\t\tconst inputState: InputState | undefined = formBase.store.state.inputStates[name];\n\t\tsetState(inputState?.error);\n\t\tsetLoading(inputState?.validateLoading);\n\t}, [formBase, name]);\n\tuseEffect(() => {\n\t\tconst callback = () => {\n\t\t\tconst inputState: InputState | undefined = formBase.store.state.inputStates[name];\n\t\t\tsetState(inputState?.error);\n\t\t\tsetLoading(inputState?.validateLoading);\n\t\t};\n\t\treturn formBase.store.subscribe(callback);\n\t}, [formBase, name]);\n\treturn { error: state && state[0], loading };\n}\n","import React, { createContext, useMemo } from \"react\";\nimport { FormBase } from \"../form-base\";\nimport { FormContextProps } from \"../models\";\n\nexport const FormContext = createContext<{ formBase: FormBase } | null>(null);\n\nexport function FormContextProvider(props: FormContextProps) {\n\tconst formBase = useMemo(\n\t\t() =>\n\t\t\tnew FormBase({\n\t\t\t\trefreshType: props?.refreshType,\n\t\t\t\tshouldValidate: props?.shouldValidate,\n\t\t\t\tdebounceNumber: props?.debounceNumber,\n\t\t\t}),\n\t\t[props?.refreshType, props?.shouldValidate]\n\t);\n\treturn <FormContext.Provider value={{ formBase }}>{props.children}</FormContext.Provider>;\n}\n","import { useContext } from \"react\";\nimport { FormContext } from \"./form-context\";\nimport { FormBase } from \"../form-base\";\nimport { throwContextError } from \"../utils\";\n\nexport function useContextFormBase(): FormBase {\n\tconst context = useContext(FormContext);\n\tif (!context) {\n\t\tthrow throwContextError(\"useContextFormBase\");\n\t}\n\treturn context.formBase;\n}\n","export function throwContextError(name: string) {\n\treturn new Error(`You cannot use ${name} outside of Form Component`);\n}\n","import React from \"react\";\nimport { FormContextProvider, useContextFormBase } from \"../form-context\";\nimport { FormDomProps, FormProps } from \"./models/form-dom-props\";\n\nconst InnerForm = React.memo((props: FormDomProps) => {\n\tconst formBase = useContextFormBase();\n\tconst { ...htmlProps } = props;\n\treturn (\n\t\t<form\n\t\t\t{...htmlProps}\n\t\t\tonSubmit={(e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tformBase\n\t\t\t\t\t.onSubmit((res, utils) => {\n\t\t\t\t\t\tif (props.onSubmit) {\n\t\t\t\t\t\t\treturn props.onSubmit(res, utils);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.then();\n\t\t\t}}\n\t\t/>\n\t);\n});\n\nexport const Form = React.memo((props: FormProps) => {\n\tconst { formBaseOptions, ...formProps } = props;\n\t//TODO: solve ts-ignore\n\treturn (\n\t\t<FormContextProvider {...formBaseOptions}>\n\t\t\t{/*@ts-ignore*/}\n\t\t\t<InnerForm {...formProps}>{props.children}</InnerForm>\n\t\t</FormContextProvider>\n\t);\n});\n","import { useEffect, useRef } from \"react\";\nimport { ValidatorToValidatorFunc } from \"../../validator\";\nimport { FormBase, useErrorForInput } from \"../../form-base\";\nimport { StoreState } from \"../../models\";\nimport { useCreateInput } from \"../../form-base/hooks/use-create-input\";\n\nexport function useCreateDomInput(\n\tformBase: FormBase,\n\tname: string,\n\tdefaultParams: { defaultValue?: any; validation?: ValidatorToValidatorFunc } = {}\n): { onChange: any; onBlur: any; ref: any; error: any; loading: boolean } {\n\tconst result: any = useCreateInput(formBase, name, defaultParams);\n\tresult.ref = useRef();\n\tconst errorNameInput = useErrorForInput(formBase, \"name\");\n\tuseEffect(() => {\n\t\tif (!name) return;\n\t\tconst callback = (state: StoreState) => {\n\t\t\tif (result.ref.current) {\n\t\t\t\tresult.ref.current.value = state.inputStates[name]?._refreshValue || \"\";\n\t\t\t}\n\t\t};\n\t\treturn formBase.store.subscribeInstant(callback);\n\t}, [formBase, result.ref, name]);\n\n\treturn { ...result, ...errorNameInput };\n}\n","import React, { useId } from \"react\";\nimport { useContextFormBase } from \"../form-context\";\nimport { useCreateDomInput } from \"./hooks/use-create-dom-input\";\nimport { InputProps } from \"./models/input.props\";\n\nexport const Input = React.memo((inputProps: InputProps) => {\n\tconst { name, validation, defaultValue, inputRef, ...htmlProps } = inputProps;\n\tconst formBase = useContextFormBase();\n\tconst id = useId();\n\tconst { onChange, onBlur, ref } = useCreateDomInput(formBase, name || id, {\n\t\tvalidation,\n\t\tdefaultValue,\n\t});\n\tconst __htmlProps: any = htmlProps;\n\treturn (\n\t\t<input\n\t\t\t{...__htmlProps}\n\t\t\tref={(el) => {\n\t\t\t\tref.current = el;\n\t\t\t\tif (inputRef) {\n\t\t\t\t\tinputRef.current = el;\n\t\t\t\t}\n\t\t\t}}\n\t\t\tonChange={(e) => {\n\t\t\t\tconst value = e.target.value;\n\t\t\t\tonChange(value);\n\t\t\t\thtmlProps.onChange && htmlProps.onChange(e);\n\t\t\t}}\n\t\t\tonBlur={(e) => {\n\t\t\t\tonBlur();\n\t\t\t\thtmlProps.onBlur && htmlProps.onBlur(e);\n\t\t\t}}\n\t\t/>\n\t);\n});\n","import React, { useId } from \"react\";\nimport { useContextFormBase } from \"../form-context\";\nimport { useCreateDomInput } from \"./hooks/use-create-dom-input\";\nimport { TextareaProps } from \"./models/textarea.props\";\n\nexport const Textarea = React.memo((textareaProps: TextareaProps) => {\n\tconst { name, validation, defaultValue, inputRef, ...htmlProps } = textareaProps;\n\tconst formBase = useContextFormBase();\n\tconst id = useId();\n\tconst { onChange, onBlur, ref } = useCreateDomInput(formBase, name || id);\n\tconst __htmlProps: any = htmlProps;\n\treturn (\n\t\t<textarea\n\t\t\t{...__htmlProps}\n\t\t\tref={(el) => {\n\t\t\t\tref.current = el;\n\t\t\t\tif (inputRef) {\n\t\t\t\t\tconsole.log(\"el\", el);\n\t\t\t\t\tinputRef.current = el;\n\t\t\t\t}\n\t\t\t}}\n\t\t\tonChange={(e) => {\n\t\t\t\tconst value = e.target.value;\n\t\t\t\tonChange(value);\n\t\t\t\thtmlProps.onChange && htmlProps.onChange(e);\n\t\t\t}}\n\t\t\tonBlur={(e) => {\n\t\t\t\tonBlur();\n\t\t\t\thtmlProps.onBlur && htmlProps.onBlur(e);\n\t\t\t}}\n\t\t/>\n\t);\n});\n","import React from \"react\";\nimport { useContextFormBase } from \"../form-context\";\nimport { useErrorForGlobal } from \"../form-base\";\n\ninterface FormErrorProps {\n\terrorMessage?: string;\n}\nexport const FormError = React.memo(({ errorMessage = \"Something went wrong\" }: FormErrorProps) => {\n\tconst formBase = useContextFormBase();\n\tconst error = useErrorForGlobal(formBase);\n\tif (!error) return null;\n\treturn <p>{typeof error === \"string\" ? error : error.message || errorMessage}</p>;\n});\n","import React from \"react\";\nimport { useContextFormBase } from \"../form-context\";\nimport { getErrorDefaultText } from \"../validator\";\nimport { useErrorForInput } from \"../form-base\";\nimport { ValidateError } from \"../models\";\n\ninterface InputErrorProps {\n\tname: string;\n\tcustomErrorText?: (error: ValidateError) => string;\n}\n\nexport const InputError = React.memo(({ name, customErrorText }: InputErrorProps) => {\n\tconst formBase = useContextFormBase();\n\tconst { error, loading } = useErrorForInput(formBase, name);\n\tif (!customErrorText) {\n\t\tcustomErrorText = (errorInner) => {\n\t\t\treturn getErrorDefaultText(errorInner);\n\t\t};\n\t}\n\treturn <p>{loading ? <span>Loading</span> : error ? customErrorText(error) : null}</p>;\n});\n","import { useCallback, useEffect, useState } from \"react\";\nimport { FormBase } from \"../form-base\";\nimport { StoreState } from \"../../models\";\n\nexport function useConfirm(formBase: FormBase) {\n\tconst [active, setActive] = useState<any>(() => formBase.store.state.formState.confirmActive);\n\tconst resolve = useCallback(\n\t\t(payload?: any) => {\n\t\t\tif (formBase.confirm) {\n\t\t\t\tformBase.confirm(true, payload);\n\t\t\t}\n\t\t},\n\t\t[formBase]\n\t);\n\tconst reject = useCallback(() => {\n\t\tif (formBase.confirm) {\n\t\t\tformBase.confirm(false);\n\t\t}\n\t}, [formBase]);\n\tuseEffect(() => {\n\t\tconst callback = (state: StoreState) => {\n\t\t\tsetActive(formBase.store.state.formState.confirmActive);\n\t\t};\n\t\treturn formBase.store.subscribe(callback);\n\t}, [formBase]);\n\treturn {\n\t\tactive,\n\t\tresolve,\n\t\treject,\n\t};\n}\n","import { Dispatch, SetStateAction, useEffect, useState } from \"react\";\nimport { FormBase } from \"../\";\nimport { StoreState } from \"../../models\";\nimport { EventType } from \"../../models/action-type\";\n\nexport function useEventChange(formBase: FormBase): [EventType[], Dispatch<SetStateAction<EventType[]>>] {\n\tconst [state, setState] = useState<EventType[]>(() => [{ ...formBase.store.__lastEvent__ }]);\n\tuseEffect(() => {\n\t\tconst callback = () => {\n\t\t\tconst event = formBase.store.__lastEvent__;\n\t\t\tsetState((s) => [...s, { ...event }]);\n\t\t};\n\t\treturn formBase.store.subscribe(callback);\n\t}, [formBase]);\n\treturn [state, setState];\n}\n","import { useEffect, useState } from \"react\";\nimport { FormBase } from \"../\";\nimport { StoreState } from \"../../models\";\n\nexport function useWatch(formBase: FormBase, name: string | undefined) {\n\tconst [state, setState] = useState<any>(() => (name ? formBase.store.state.inputStates[name]?.value : undefined));\n\tuseEffect(() => {\n\t\tname && setState(formBase.store.state.inputStates[name]?.value);\n\t}, [formBase, name]);\n\tuseEffect(() => {\n\t\tif (!name) return;\n\t\tconst callback = (state: StoreState) => {\n\t\t\tsetState(state.inputStates[name]?.value);\n\t\t};\n\t\treturn formBase.store.subscribe(callback);\n\t}, [formBase, name]);\n\treturn state;\n}\nexport function useInstantWatch(formBase: FormBase, name: string | undefined) {\n\tconst [state, setState] = useState<any>(() =>\n\t\tname ? formBase.store.state.inputStates[name]?._refreshValue : undefined\n\t);\n\tuseEffect(() => {\n\t\tname && setState(formBase.store.state.inputStates[name]?._refreshValue);\n\t}, [formBase, name]);\n\n\tuseEffect(() => {\n\t\tif (!name) return;\n\t\tconst callback = (state: StoreState) => {\n\t\t\tsetState(state.inputStates[name]?._refreshValue);\n\t\t};\n\t\treturn formBase.store.subscribeInstant(callback);\n\t}, [formBase, name]);\n\treturn state;\n}\n","import { useEffect, useState } from \"react\";\nimport { FormBase } from \"../form-base\";\nimport { StoreState } from \"../../models\";\n\nexport function useLoading(formBase: FormBase) {\n\tconst [state, setState] = useState<any>(() => formBase.store.state.formState?.loading);\n\tuseEffect(() => {\n\t\tsetState(formBase.store.state.formState?.loading);\n\t}, [formBase]);\n\tuseEffect(() => {\n\t\tconst callback = (state: StoreState) => {\n\t\t\tsetState(state.formState.loading);\n\t\t};\n\t\treturn formBase.store.subscribe(callback);\n\t}, [formBase]);\n\treturn state;\n}\n","import { useEffect, useRef, useState } from \"react\";\nimport { FormBase } from \"../form-base\";\nimport { ResponseData } from \"../../models\";\n\nexport function useResponseDataWatch(formBase: FormBase) {\n\tconst [state, setState] = useState<ResponseData>(() => formBase.getDataWithoutValidation());\n\tconst submitAttemptNumber = useRef(0);\n\tuseEffect(() => {\n\t\tconst store = formBase.store;\n\t\tconst callback = async () => {\n\t\t\tconst formState = store.state.formState;\n\t\t\tconst formStatus = formState.formStatus;\n\t\t\tif (formStatus !== \"NOT-CLEAN\") return;\n\t\t\tconst formStateSubmitAttemptNumber = formState.submitAttemptNumber;\n\t\t\tconst responseData = await formBase.getDataWithValidation(\n\t\t\t\tsubmitAttemptNumber.current !== formStateSubmitAttemptNumber,\n\t\t\t\t{\n\t\t\t\t\tvalidateLoading: false,\n\t\t\t\t}\n\t\t\t);\n\t\t\tif (submitAttemptNumber.current !== formStateSubmitAttemptNumber) {\n\t\t\t\tsubmitAttemptNumber.current = formStateSubmitAttemptNumber;\n\t\t\t}\n\t\t\tsetState(responseData);\n\t\t};\n\t\treturn store.subscribe(callback);\n\t}, [formBase]);\n\treturn state;\n}\n","import { useEffect, useState } from \"react\";\nimport { FormBase } from \"../form-base\";\nimport { StoreState } from \"../../models\";\n\nexport function useStoreStateWatch(formBase: FormBase, instantType: \"instant\" | \"normal\") {\n\tconst [state, setState] = useState<StoreState>(() => formBase.store.state);\n\tuseEffect(() => {\n\t\tconst callback = (state: StoreState) => {\n\t\t\tsetState({\n\t\t\t\t...state,\n\t\t\t});\n\t\t};\n\t\tif (instantType === \"instant\") {\n\t\t\treturn formBase.store.subscribeInstant(callback);\n\t\t} else {\n\t\t\treturn formBase.store.subscribe(callback);\n\t\t}\n\t}, [instantType, formBase]);\n\treturn state;\n}\n"],"names":["FormRefreshType","FormShouldValidateType","ActionType","throwNotRegistered","name","Error","instant","Debounce","time","__select_time","constructor","this","cb","reset","setTimeout","clearTimeout","reducer","state","action","setError","currentInputState","error","formState","formStatus","Object","values","inputStates","reduce","p","c","type","INIT","BLURRED_DEBOUNCED","NEW_VALUE_DEBOUNCED","payload","validateRequired","value","_refreshValue","Array","isArray","NEW_VALUE","refreshType","debounceNumber","BLURRED","blur","SUBMIT_STARTED","loading","confirmActive","submitAttemptNumber","SUBMIT_SUCCEED","forEach","s","SUBMIT_ERROR","e","console","warn","ASYNC_VALIDATION","forSubmit","validateLoading","Store","listeners","instantListeners","debounce","__inputValidationFunctions__","__lastEvent__","actionProps","undefined","index","subscribe","fn","push","splice","indexOf","subscribeInstant","dispatch","log","instantBroadcast","broadcast","getValidationData","entries","filter","inputState","data","key","createInput","options","defaultValue","l","getRawData","getShouldValidateAgain","sum","r","addValidation","validation","phoneRegex","emailRegex","urlHttpRegex","required","min","_value","Number","isNaN","minLength","length","max","maxLength","email","toLowerCase","match","phone","repeatPassword","url","customRegex","regex","test","ValidatorType","Validator","store","validateName","validations","settings","validateAll","register","v","storeData","validate","async","registerAsync","set","param","getErrorDefaultText","message","FormBase","confirm","shouldValidate","AFTER_FIRST_SUBMIT_ATTEMPT","onSubmit","bind","getDataWithoutValidation","isValid","validateErrors","shouldValidateAgain","responseData","formSubmitFunction","is","getDataWithValidation","_fn","succeed","result","onSubmitResult","errors","i","shouldValidateObj","shouldValidateType","YES","onChange","setValue","then","onBlur","validateInput","validatorToValidatorFunc","deleteInput","checkNameExist","validated","validationFunction","array","vKeys","keys","j","vKey","vObj","obj","catch","useCreateInput","formBase","defaultParams","useInsertionEffect","useErrorForGlobal","setState","useState","useEffect","useErrorForInput","setLoading","FormContext","createContext","FormContextProvider","props","useMemo","React","createElement","Provider","children","useContextFormBase","context","useContext","InnerForm","memo","htmlProps","preventDefault","res","utils","Form","formBaseOptions","formProps","useCreateDomInput","ref","useRef","errorNameInput","current","Input","inputProps","inputRef","id","useId","__htmlProps","el","target","Textarea","textareaProps","FormError","errorMessage","InputError","customErrorText","errorInner","active","setActive","resolve","useCallback","reject","event","formStateSubmitAttemptNumber","instantType","callback"],"mappings":"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"}